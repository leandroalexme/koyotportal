/**
 * EQI Financial Report Template (A4) - V2
 * 
 * Relatório financeiro profissional - 210mm x 297mm
 * Dimensões: 1240px x 1754px (scaled for web preview)
 * 
 * Design profissional seguindo melhores práticas:
 * - Header com barra verde institucional + logo branco
 * - Bloco de informações do cliente
 * - 4 KPI cards em grid 2x2
 * - Tabela de alocação com header colorido e linhas alternadas
 * - Tabela de movimentações recentes
 * - Footer com disclaimer e contato
 */

import type { Template, FrameNode, TextNode, Color } from '@/types/studio'
import { DEFAULT_GOVERNANCE } from '@/types/studio'
import { EQI_COLORS, EQI_TEXT_STYLES, DATA_FIELD_GOVERNANCE } from '@/lib/brands/eqi-design-system'

const EQI_BRAND_ID = 'a0295b8d-c0f9-49db-b839-8a6021d3ecf7'

// Design tokens
const C = {
  primary: EQI_COLORS.primary.main,
  primaryLight: EQI_COLORS.primary.light,
  accent: EQI_COLORS.primary.accent,
  white: EQI_COLORS.surface.white,
  bgLight: EQI_COLORS.surface.light,
  textDark: EQI_COLORS.text.primary,
  textMuted: EQI_COLORS.text.muted,
  textWhite: EQI_COLORS.text.light,
  success: EQI_COLORS.accent.success,
  error: EQI_COLORS.accent.error,
  tableAlt: { r: 249, g: 250, b: 251, a: 1 } as Color,
  border: { r: 229, g: 231, b: 235, a: 1 } as Color,
}

// Layout helpers
const fillHug = {
  layoutMode: 'NONE' as const,
  horizontalSizing: 'FILL' as const,
  verticalSizing: 'HUG' as const,
  primaryAxisAlignment: 'START' as const,
  counterAxisAlignment: 'START' as const,
  padding: { top: 0, right: 0, bottom: 0, left: 0 },
  gap: 0,
  wrap: false,
}

// ============================================
// HEADER - Barra verde com logo
// ============================================

const headerBar: FrameNode = {
  id: 'rpt-header-bar',
  name: 'Header Bar',
  type: 'FRAME',
  visible: true,
  locked: true,
  opacity: 1,
  blendMode: 'NORMAL',
  position: { x: 0, y: 0 },
  size: { width: 1240, height: 80 },
  rotation: 0,
  cornerRadius: 0,
  fills: [{ type: 'SOLID', color: C.primary }],
  shadows: [],
  autoLayout: {
    layoutMode: 'HORIZONTAL',
    horizontalSizing: 'FIXED',
    verticalSizing: 'FIXED',
    primaryAxisAlignment: 'SPACE_BETWEEN',
    counterAxisAlignment: 'CENTER',
    padding: { top: 0, right: 60, bottom: 0, left: 60 },
    gap: 0,
    wrap: false,
  },
  clipsContent: false,
  children: [
    {
      id: 'rpt-logo',
      name: 'Logo',
      type: 'TEXT',
      visible: true,
      locked: true,
      opacity: 1,
      blendMode: 'NORMAL',
      position: { x: 0, y: 0 },
      size: { width: 0, height: 0 },
      rotation: 0,
      cornerRadius: 0,
      fills: [{ type: 'SOLID', color: C.textWhite }],
      shadows: [],
      autoLayout: { ...fillHug, horizontalSizing: 'HUG' },
      governance: DEFAULT_GOVERNANCE,
      textProps: {
        content: 'EQI',
        style: { ...EQI_TEXT_STYLES.displayMd, fontSize: 32, fontWeight: 700 },
        editable: false,
      },
    } as TextNode,
    {
      id: 'rpt-header-title',
      name: 'Título',
      type: 'TEXT',
      visible: true,
      locked: false,
      opacity: 1,
      blendMode: 'NORMAL',
      position: { x: 0, y: 0 },
      size: { width: 0, height: 0 },
      rotation: 0,
      cornerRadius: 0,
      fills: [{ type: 'SOLID', color: C.textWhite }],
      shadows: [],
      autoLayout: { ...fillHug, horizontalSizing: 'HUG' },
      governance: DEFAULT_GOVERNANCE,
      textProps: {
        content: 'RELATÓRIO DE PERFORMANCE',
        style: { ...EQI_TEXT_STYLES.h2, fontWeight: 500, textAlign: 'RIGHT' },
        editable: true,
      },
    } as TextNode,
  ],
  governance: DEFAULT_GOVERNANCE,
}

// ============================================
// CLIENT INFO BLOCK
// ============================================

const clientInfoBlock: FrameNode = {
  id: 'rpt-client-info',
  name: 'Informações do Cliente',
  type: 'FRAME',
  visible: true,
  locked: false,
  opacity: 1,
  blendMode: 'NORMAL',
  position: { x: 0, y: 0 },
  size: { width: 0, height: 0 },
  rotation: 0,
  cornerRadius: 0,
  fills: [],
  shadows: [],
  autoLayout: {
    layoutMode: 'HORIZONTAL',
    horizontalSizing: 'FILL',
    verticalSizing: 'HUG',
    primaryAxisAlignment: 'SPACE_BETWEEN',
    counterAxisAlignment: 'START',
    padding: { top: 24, right: 0, bottom: 24, left: 0 },
    gap: 24,
    wrap: false,
  },
  clipsContent: false,
  children: [
    // Left column - Client name and account
    {
      id: 'rpt-client-left',
      name: 'Cliente',
      type: 'FRAME',
      visible: true,
      locked: false,
      opacity: 1,
      blendMode: 'NORMAL',
      position: { x: 0, y: 0 },
      size: { width: 0, height: 0 },
      rotation: 0,
      cornerRadius: 0,
      fills: [],
      shadows: [],
      autoLayout: {
        layoutMode: 'VERTICAL',
        horizontalSizing: 'HUG',
        verticalSizing: 'HUG',
        primaryAxisAlignment: 'START',
        counterAxisAlignment: 'START',
        padding: { top: 0, right: 0, bottom: 0, left: 0 },
        gap: 4,
        wrap: false,
      },
      clipsContent: false,
      children: [
        {
          id: 'rpt-client-label',
          name: 'Label Cliente',
          type: 'TEXT',
          visible: true,
          locked: true,
          opacity: 1,
          blendMode: 'NORMAL',
          position: { x: 0, y: 0 },
          size: { width: 0, height: 0 },
          rotation: 0,
          cornerRadius: 0,
          fills: [{ type: 'SOLID', color: C.textMuted }],
          shadows: [],
          autoLayout: fillHug,
          governance: DEFAULT_GOVERNANCE,
          textProps: {
            content: 'CLIENTE',
            style: { ...EQI_TEXT_STYLES.caption, textTransform: 'UPPERCASE', letterSpacing: 0.08 },
            editable: false,
          },
        } as TextNode,
        {
          id: 'rpt-client-name',
          name: 'Nome Cliente',
          type: 'TEXT',
          visible: true,
          locked: false,
          opacity: 1,
          blendMode: 'NORMAL',
          position: { x: 0, y: 0 },
          size: { width: 0, height: 0 },
          rotation: 0,
          cornerRadius: 0,
          fills: [{ type: 'SOLID', color: C.textDark }],
          shadows: [],
          autoLayout: fillHug,
          governance: DATA_FIELD_GOVERNANCE,
          textProps: {
            content: 'João Carlos da Silva',
            style: { ...EQI_TEXT_STYLES.h2, fontWeight: 600 },
            editable: true,
          },
        } as TextNode,
        {
          id: 'rpt-client-account',
          name: 'Conta',
          type: 'TEXT',
          visible: true,
          locked: false,
          opacity: 1,
          blendMode: 'NORMAL',
          position: { x: 0, y: 0 },
          size: { width: 0, height: 0 },
          rotation: 0,
          cornerRadius: 0,
          fills: [{ type: 'SOLID', color: C.textMuted }],
          shadows: [],
          autoLayout: fillHug,
          governance: DATA_FIELD_GOVERNANCE,
          textProps: {
            content: 'Conta: 12345-6 | CPF: ***.***.789-00',
            style: EQI_TEXT_STYLES.bodySm,
            editable: true,
          },
        } as TextNode,
      ],
      governance: DEFAULT_GOVERNANCE,
    } as FrameNode,
    // Right column - Period
    {
      id: 'rpt-period',
      name: 'Período',
      type: 'FRAME',
      visible: true,
      locked: false,
      opacity: 1,
      blendMode: 'NORMAL',
      position: { x: 0, y: 0 },
      size: { width: 0, height: 0 },
      rotation: 0,
      cornerRadius: 0,
      fills: [],
      shadows: [],
      autoLayout: {
        layoutMode: 'VERTICAL',
        horizontalSizing: 'HUG',
        verticalSizing: 'HUG',
        primaryAxisAlignment: 'START',
        counterAxisAlignment: 'END',
        padding: { top: 0, right: 0, bottom: 0, left: 0 },
        gap: 4,
        wrap: false,
      },
      clipsContent: false,
      children: [
        {
          id: 'rpt-period-label',
          name: 'Label Período',
          type: 'TEXT',
          visible: true,
          locked: true,
          opacity: 1,
          blendMode: 'NORMAL',
          position: { x: 0, y: 0 },
          size: { width: 0, height: 0 },
          rotation: 0,
          cornerRadius: 0,
          fills: [{ type: 'SOLID', color: C.textMuted }],
          shadows: [],
          autoLayout: fillHug,
          governance: DEFAULT_GOVERNANCE,
          textProps: {
            content: 'PERÍODO',
            style: { ...EQI_TEXT_STYLES.caption, textTransform: 'UPPERCASE', letterSpacing: 0.08, textAlign: 'RIGHT' },
            editable: false,
          },
        } as TextNode,
        {
          id: 'rpt-period-value',
          name: 'Valor Período',
          type: 'TEXT',
          visible: true,
          locked: false,
          opacity: 1,
          blendMode: 'NORMAL',
          position: { x: 0, y: 0 },
          size: { width: 0, height: 0 },
          rotation: 0,
          cornerRadius: 0,
          fills: [{ type: 'SOLID', color: C.textDark }],
          shadows: [],
          autoLayout: fillHug,
          governance: DATA_FIELD_GOVERNANCE,
          textProps: {
            content: 'Janeiro 2026',
            style: { ...EQI_TEXT_STYLES.h2, fontWeight: 600, textAlign: 'RIGHT' },
            editable: true,
          },
        } as TextNode,
        {
          id: 'rpt-period-dates',
          name: 'Datas',
          type: 'TEXT',
          visible: true,
          locked: false,
          opacity: 1,
          blendMode: 'NORMAL',
          position: { x: 0, y: 0 },
          size: { width: 0, height: 0 },
          rotation: 0,
          cornerRadius: 0,
          fills: [{ type: 'SOLID', color: C.textMuted }],
          shadows: [],
          autoLayout: fillHug,
          governance: DATA_FIELD_GOVERNANCE,
          textProps: {
            content: '01/01/2026 a 31/01/2026',
            style: { ...EQI_TEXT_STYLES.bodySm, textAlign: 'RIGHT' },
            editable: true,
          },
        } as TextNode,
      ],
      governance: DEFAULT_GOVERNANCE,
    } as FrameNode,
  ],
  governance: DEFAULT_GOVERNANCE,
}

// ============================================
// KPI CARDS - 4 cards in 2x2 grid
// ============================================

function createKpiCard(id: string, label: string, value: string, change: string, isPositive: boolean): FrameNode {
  return {
    id,
    name: label,
    type: 'FRAME',
    visible: true,
    locked: false,
    opacity: 1,
    blendMode: 'NORMAL',
    position: { x: 0, y: 0 },
    size: { width: 0, height: 0 },
    rotation: 0,
    cornerRadius: 8,
    fills: [{ type: 'SOLID', color: C.bgLight }],
    shadows: [],
    autoLayout: {
      layoutMode: 'VERTICAL',
      horizontalSizing: 'FILL',
      verticalSizing: 'HUG',
      primaryAxisAlignment: 'START',
      counterAxisAlignment: 'START',
      padding: { top: 20, right: 20, bottom: 20, left: 20 },
      gap: 8,
      wrap: false,
    },
    clipsContent: false,
    children: [
      {
        id: `${id}-label`,
        name: 'Label',
        type: 'TEXT',
        visible: true,
        locked: true,
        opacity: 1,
        blendMode: 'NORMAL',
        position: { x: 0, y: 0 },
        size: { width: 0, height: 0 },
        rotation: 0,
        cornerRadius: 0,
        fills: [{ type: 'SOLID', color: C.textMuted }],
        shadows: [],
        autoLayout: fillHug,
        governance: DEFAULT_GOVERNANCE,
        textProps: {
          content: label,
          style: { ...EQI_TEXT_STYLES.caption, textTransform: 'UPPERCASE', letterSpacing: 0.05 },
          editable: false,
        },
      } as TextNode,
      {
        id: `${id}-value`,
        name: 'Valor',
        type: 'TEXT',
        visible: true,
        locked: false,
        opacity: 1,
        blendMode: 'NORMAL',
        position: { x: 0, y: 0 },
        size: { width: 0, height: 0 },
        rotation: 0,
        cornerRadius: 0,
        fills: [{ type: 'SOLID', color: C.textDark }],
        shadows: [],
        autoLayout: fillHug,
        governance: DATA_FIELD_GOVERNANCE,
        textProps: {
          content: value,
          style: { ...EQI_TEXT_STYLES.h1, fontSize: 28, fontWeight: 700 },
          editable: true,
        },
      } as TextNode,
      {
        id: `${id}-change`,
        name: 'Variação',
        type: 'TEXT',
        visible: true,
        locked: false,
        opacity: 1,
        blendMode: 'NORMAL',
        position: { x: 0, y: 0 },
        size: { width: 0, height: 0 },
        rotation: 0,
        cornerRadius: 0,
        fills: [{ type: 'SOLID', color: isPositive ? C.success : C.error }],
        shadows: [],
        autoLayout: fillHug,
        governance: DATA_FIELD_GOVERNANCE,
        textProps: {
          content: change,
          style: { ...EQI_TEXT_STYLES.bodySm, fontWeight: 500 },
          editable: true,
        },
      } as TextNode,
    ],
    governance: DEFAULT_GOVERNANCE,
  }
}

const kpiGrid: FrameNode = {
  id: 'rpt-kpi-grid',
  name: 'KPIs',
  type: 'FRAME',
  visible: true,
  locked: false,
  opacity: 1,
  blendMode: 'NORMAL',
  position: { x: 0, y: 0 },
  size: { width: 0, height: 0 },
  rotation: 0,
  cornerRadius: 0,
  fills: [],
  shadows: [],
  autoLayout: {
    layoutMode: 'HORIZONTAL',
    horizontalSizing: 'FILL',
    verticalSizing: 'HUG',
    primaryAxisAlignment: 'START',
    counterAxisAlignment: 'START',
    padding: { top: 0, right: 0, bottom: 0, left: 0 },
    gap: 16,
    wrap: true,
  },
  clipsContent: false,
  children: [
    createKpiCard('kpi-patrimonio', 'Patrimônio Total', 'R$ 1.250.000,00', '+R$ 45.320,00 no mês', true),
    createKpiCard('kpi-rent-mes', 'Rentabilidade Mês', '+2,45%', '+0,32% vs CDI', true),
    createKpiCard('kpi-rent-ano', 'Rentabilidade Ano', '+8,72%', '+1,15% vs CDI', true),
    createKpiCard('kpi-rent-inicio', 'Desde o Início', '+42,18%', 'Início: Jan/2023', true),
  ],
  governance: DEFAULT_GOVERNANCE,
}

// ============================================
// ALLOCATION TABLE
// ============================================

function createTableCell(id: string, content: string, isHeader: boolean, align: 'LEFT' | 'CENTER' | 'RIGHT' = 'LEFT', color?: Color): TextNode {
  return {
    id,
    name: content,
    type: 'TEXT',
    visible: true,
    locked: isHeader,
    opacity: 1,
    blendMode: 'NORMAL',
    position: { x: 0, y: 0 },
    size: { width: 0, height: 0 },
    rotation: 0,
    cornerRadius: 0,
    fills: [{ type: 'SOLID', color: color || (isHeader ? C.textWhite : C.textDark) }],
    shadows: [],
    autoLayout: fillHug,
    governance: isHeader ? DEFAULT_GOVERNANCE : DATA_FIELD_GOVERNANCE,
    textProps: {
      content,
      style: {
        ...EQI_TEXT_STYLES.bodySm,
        fontWeight: isHeader ? 600 : 400,
        textAlign: align,
      },
      editable: !isHeader,
    },
  }
}

function createTableRow(id: string, cells: { content: string; align?: 'LEFT' | 'CENTER' | 'RIGHT'; color?: Color }[], isHeader: boolean, isAlt: boolean = false): FrameNode {
  return {
    id,
    name: isHeader ? 'Header' : 'Row',
    type: 'FRAME',
    visible: true,
    locked: isHeader,
    opacity: 1,
    blendMode: 'NORMAL',
    position: { x: 0, y: 0 },
    size: { width: 0, height: 0 },
    rotation: 0,
    cornerRadius: 0,
    fills: isHeader ? [{ type: 'SOLID', color: C.primary }] : (isAlt ? [{ type: 'SOLID', color: C.tableAlt }] : []),
    shadows: [],
    autoLayout: {
      layoutMode: 'HORIZONTAL',
      horizontalSizing: 'FILL',
      verticalSizing: 'HUG',
      primaryAxisAlignment: 'START',
      counterAxisAlignment: 'CENTER',
      padding: { top: 12, right: 16, bottom: 12, left: 16 },
      gap: 0,
      wrap: false,
    },
    clipsContent: false,
    children: cells.map((cell, i) => createTableCell(`${id}-c${i}`, cell.content, isHeader, cell.align || 'LEFT', cell.color)),
    governance: DEFAULT_GOVERNANCE,
  }
}

const sectionTitleAllocation: TextNode = {
  id: 'rpt-alloc-title',
  name: 'Título Alocação',
  type: 'TEXT',
  visible: true,
  locked: true,
  opacity: 1,
  blendMode: 'NORMAL',
  position: { x: 0, y: 0 },
  size: { width: 0, height: 0 },
  rotation: 0,
  cornerRadius: 0,
  fills: [{ type: 'SOLID', color: C.textDark }],
  shadows: [],
  autoLayout: fillHug,
  governance: DEFAULT_GOVERNANCE,
  textProps: {
    content: 'Alocação por Classe de Ativo',
    style: { ...EQI_TEXT_STYLES.h3, fontWeight: 600 },
    editable: false,
  },
}

const allocationTable: FrameNode = {
  id: 'rpt-alloc-table',
  name: 'Tabela Alocação',
  type: 'FRAME',
  visible: true,
  locked: false,
  opacity: 1,
  blendMode: 'NORMAL',
  position: { x: 0, y: 0 },
  size: { width: 0, height: 0 },
  rotation: 0,
  cornerRadius: 8,
  fills: [{ type: 'SOLID', color: C.white }],
  shadows: [],
  autoLayout: {
    layoutMode: 'VERTICAL',
    horizontalSizing: 'FILL',
    verticalSizing: 'HUG',
    primaryAxisAlignment: 'START',
    counterAxisAlignment: 'START',
    padding: { top: 0, right: 0, bottom: 0, left: 0 },
    gap: 0,
    wrap: false,
  },
  clipsContent: true,
  children: [
    createTableRow('alloc-h', [
      { content: 'Classe de Ativo', align: 'LEFT' },
      { content: 'Valor (R$)', align: 'RIGHT' },
      { content: '% Carteira', align: 'RIGHT' },
      { content: 'Rent. Mês', align: 'RIGHT' },
      { content: 'Rent. Ano', align: 'RIGHT' },
    ], true),
    createTableRow('alloc-1', [
      { content: 'Renda Fixa' },
      { content: '625.000,00', align: 'RIGHT' },
      { content: '50,0%', align: 'RIGHT' },
      { content: '+1,12%', align: 'RIGHT', color: C.success },
      { content: '+6,45%', align: 'RIGHT', color: C.success },
    ], false, false),
    createTableRow('alloc-2', [
      { content: 'Renda Variável' },
      { content: '312.500,00', align: 'RIGHT' },
      { content: '25,0%', align: 'RIGHT' },
      { content: '+4,85%', align: 'RIGHT', color: C.success },
      { content: '+12,30%', align: 'RIGHT', color: C.success },
    ], false, true),
    createTableRow('alloc-3', [
      { content: 'Fundos Multimercado' },
      { content: '187.500,00', align: 'RIGHT' },
      { content: '15,0%', align: 'RIGHT' },
      { content: '+2,30%', align: 'RIGHT', color: C.success },
      { content: '+8,90%', align: 'RIGHT', color: C.success },
    ], false, false),
    createTableRow('alloc-4', [
      { content: 'Fundos Imobiliários' },
      { content: '125.000,00', align: 'RIGHT' },
      { content: '10,0%', align: 'RIGHT' },
      { content: '+1,95%', align: 'RIGHT', color: C.success },
      { content: '+7,20%', align: 'RIGHT', color: C.success },
    ], false, true),
  ],
  governance: DEFAULT_GOVERNANCE,
}

const allocationSection: FrameNode = {
  id: 'rpt-alloc-section',
  name: 'Seção Alocação',
  type: 'FRAME',
  visible: true,
  locked: false,
  opacity: 1,
  blendMode: 'NORMAL',
  position: { x: 0, y: 0 },
  size: { width: 0, height: 0 },
  rotation: 0,
  cornerRadius: 0,
  fills: [],
  shadows: [],
  autoLayout: {
    layoutMode: 'VERTICAL',
    horizontalSizing: 'FILL',
    verticalSizing: 'HUG',
    primaryAxisAlignment: 'START',
    counterAxisAlignment: 'START',
    padding: { top: 24, right: 0, bottom: 0, left: 0 },
    gap: 12,
    wrap: false,
  },
  clipsContent: false,
  children: [sectionTitleAllocation, allocationTable],
  governance: DEFAULT_GOVERNANCE,
}

// ============================================
// MOVEMENTS TABLE
// ============================================

const sectionTitleMovements: TextNode = {
  id: 'rpt-mov-title',
  name: 'Título Movimentações',
  type: 'TEXT',
  visible: true,
  locked: true,
  opacity: 1,
  blendMode: 'NORMAL',
  position: { x: 0, y: 0 },
  size: { width: 0, height: 0 },
  rotation: 0,
  cornerRadius: 0,
  fills: [{ type: 'SOLID', color: C.textDark }],
  shadows: [],
  autoLayout: fillHug,
  governance: DEFAULT_GOVERNANCE,
  textProps: {
    content: 'Movimentações do Período',
    style: { ...EQI_TEXT_STYLES.h3, fontWeight: 600 },
    editable: false,
  },
}

const movementsTable: FrameNode = {
  id: 'rpt-mov-table',
  name: 'Tabela Movimentações',
  type: 'FRAME',
  visible: true,
  locked: false,
  opacity: 1,
  blendMode: 'NORMAL',
  position: { x: 0, y: 0 },
  size: { width: 0, height: 0 },
  rotation: 0,
  cornerRadius: 8,
  fills: [{ type: 'SOLID', color: C.white }],
  shadows: [],
  autoLayout: {
    layoutMode: 'VERTICAL',
    horizontalSizing: 'FILL',
    verticalSizing: 'HUG',
    primaryAxisAlignment: 'START',
    counterAxisAlignment: 'START',
    padding: { top: 0, right: 0, bottom: 0, left: 0 },
    gap: 0,
    wrap: false,
  },
  clipsContent: true,
  children: [
    createTableRow('mov-h', [
      { content: 'Data', align: 'LEFT' },
      { content: 'Descrição', align: 'LEFT' },
      { content: 'Tipo', align: 'CENTER' },
      { content: 'Valor (R$)', align: 'RIGHT' },
    ], true),
    createTableRow('mov-1', [
      { content: '05/01/2026' },
      { content: 'Aplicação CDB Banco XYZ' },
      { content: 'Aplicação', align: 'CENTER' },
      { content: '+50.000,00', align: 'RIGHT', color: C.success },
    ], false, false),
    createTableRow('mov-2', [
      { content: '12/01/2026' },
      { content: 'Dividendos PETR4' },
      { content: 'Provento', align: 'CENTER' },
      { content: '+1.250,00', align: 'RIGHT', color: C.success },
    ], false, true),
    createTableRow('mov-3', [
      { content: '18/01/2026' },
      { content: 'Resgate Fundo DI' },
      { content: 'Resgate', align: 'CENTER' },
      { content: '-15.000,00', align: 'RIGHT', color: C.error },
    ], false, false),
  ],
  governance: DEFAULT_GOVERNANCE,
}

const movementsSection: FrameNode = {
  id: 'rpt-mov-section',
  name: 'Seção Movimentações',
  type: 'FRAME',
  visible: true,
  locked: false,
  opacity: 1,
  blendMode: 'NORMAL',
  position: { x: 0, y: 0 },
  size: { width: 0, height: 0 },
  rotation: 0,
  cornerRadius: 0,
  fills: [],
  shadows: [],
  autoLayout: {
    layoutMode: 'VERTICAL',
    horizontalSizing: 'FILL',
    verticalSizing: 'HUG',
    primaryAxisAlignment: 'START',
    counterAxisAlignment: 'START',
    padding: { top: 24, right: 0, bottom: 0, left: 0 },
    gap: 12,
    wrap: false,
  },
  clipsContent: false,
  children: [sectionTitleMovements, movementsTable],
  governance: DEFAULT_GOVERNANCE,
}

// ============================================
// FOOTER
// ============================================

const footer: FrameNode = {
  id: 'rpt-footer',
  name: 'Footer',
  type: 'FRAME',
  visible: true,
  locked: true,
  opacity: 1,
  blendMode: 'NORMAL',
  position: { x: 0, y: 0 },
  size: { width: 0, height: 0 },
  rotation: 0,
  cornerRadius: 0,
  fills: [],
  shadows: [],
  autoLayout: {
    layoutMode: 'VERTICAL',
    horizontalSizing: 'FILL',
    verticalSizing: 'HUG',
    primaryAxisAlignment: 'END',
    counterAxisAlignment: 'START',
    padding: { top: 24, right: 0, bottom: 0, left: 0 },
    gap: 8,
    wrap: false,
  },
  clipsContent: false,
  children: [
    {
      id: 'rpt-footer-line',
      name: 'Linha',
      type: 'FRAME',
      visible: true,
      locked: true,
      opacity: 1,
      blendMode: 'NORMAL',
      position: { x: 0, y: 0 },
      size: { width: 0, height: 1 },
      rotation: 0,
      cornerRadius: 0,
      fills: [{ type: 'SOLID', color: C.border }],
      shadows: [],
      autoLayout: {
        layoutMode: 'NONE',
        horizontalSizing: 'FILL',
        verticalSizing: 'FIXED',
        primaryAxisAlignment: 'START',
        counterAxisAlignment: 'START',
        padding: { top: 0, right: 0, bottom: 0, left: 0 },
        gap: 0,
        wrap: false,
      },
      clipsContent: false,
      children: [],
      governance: DEFAULT_GOVERNANCE,
    } as FrameNode,
    {
      id: 'rpt-disclaimer',
      name: 'Disclaimer',
      type: 'TEXT',
      visible: true,
      locked: true,
      opacity: 1,
      blendMode: 'NORMAL',
      position: { x: 0, y: 0 },
      size: { width: 0, height: 0 },
      rotation: 0,
      cornerRadius: 0,
      fills: [{ type: 'SOLID', color: C.textMuted }],
      shadows: [],
      autoLayout: fillHug,
      governance: DEFAULT_GOVERNANCE,
      textProps: {
        content: 'Este relatório é meramente informativo e não constitui recomendação de investimento. Rentabilidade passada não é garantia de rentabilidade futura. Os valores apresentados podem sofrer alterações. EQI Investimentos - CNPJ: 35.950.807/0001-90 - Av. Brigadeiro Faria Lima, 3477, 14º andar - São Paulo, SP - CEP 04538-133',
        style: { ...EQI_TEXT_STYLES.regulatory, lineHeight: 1.4 },
        editable: false,
      },
    } as TextNode,
  ],
  governance: DEFAULT_GOVERNANCE,
}

// ============================================
// CONTENT WRAPPER (with padding)
// ============================================

const contentWrapper: FrameNode = {
  id: 'rpt-content',
  name: 'Conteúdo',
  type: 'FRAME',
  visible: true,
  locked: false,
  opacity: 1,
  blendMode: 'NORMAL',
  position: { x: 0, y: 0 },
  size: { width: 0, height: 0 },
  rotation: 0,
  cornerRadius: 0,
  fills: [],
  shadows: [],
  autoLayout: {
    layoutMode: 'VERTICAL',
    horizontalSizing: 'FILL',
    verticalSizing: 'FILL',
    primaryAxisAlignment: 'START',
    counterAxisAlignment: 'START',
    padding: { top: 0, right: 60, bottom: 40, left: 60 },
    gap: 0,
    wrap: false,
  },
  clipsContent: false,
  children: [clientInfoBlock, kpiGrid, allocationSection, movementsSection, footer],
  governance: DEFAULT_GOVERNANCE,
}

// ============================================
// ROOT NODE
// ============================================

const rootNode: FrameNode = {
  id: 'rpt-root',
  name: 'Relatório Financeiro A4',
  type: 'FRAME',
  visible: true,
  locked: false,
  opacity: 1,
  blendMode: 'NORMAL',
  position: { x: 0, y: 0 },
  size: { width: 1240, height: 1754 },
  rotation: 0,
  cornerRadius: 0,
  fills: [{ type: 'SOLID', color: C.white }],
  shadows: [],
  autoLayout: {
    layoutMode: 'VERTICAL',
    horizontalSizing: 'FIXED',
    verticalSizing: 'FIXED',
    primaryAxisAlignment: 'START',
    counterAxisAlignment: 'START',
    padding: { top: 0, right: 0, bottom: 0, left: 0 },
    gap: 0,
    wrap: false,
  },
  clipsContent: true,
  children: [headerBar, contentWrapper],
  governance: DEFAULT_GOVERNANCE,
}

export const eqiFinancialReportTemplate: Template = {
  id: 'eqi-financial-report-v2',
  name: 'Relatório Financeiro EQI',
  description: 'Relatório de performance de carteira profissional - A4',
  category: 'print_one_pager',
  format: 'one_pager',
  brandId: EQI_BRAND_ID,
  rootNode,
  schemaVersion: 1,
  tags: ['relatorio', 'financeiro', 'report', 'eqi', 'a4', 'print', 'tabela', 'performance'],
  isPublic: false,
  aiGenerated: false,
  createdAt: '2026-01-06T00:00:00.000Z',
  updatedAt: '2026-01-06T00:00:00.000Z',
  createdBy: 'system',
}
